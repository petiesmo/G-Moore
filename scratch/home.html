<!DOCTYPE html>
<html>
<head>
<title>Peter's Test Map</title>
	<h1>Test Page</h1>
<hr>
<style>
    #map{
      height:400px;
      width:100%;
    }
</style>
<script>
	//https://www.ngdc.noaa.gov/geomag/image/compass/compass_" + degrees + ".png
	function myFunction(that) {
		//console.log("I have changed the Site to: " + val)
		console.log(that.Latitude1.value)
		console.log(that.Longitude1.value)
		console.log(`Lat1: $(LatA), Long1: $(LongA)`)
		return false;}
</script>
</head>	

<body>
<form id="LocationsForm" onsubmit='getData'>	
<div class="span-12">
	<fieldset style="width:200px; background-color:bisque;">
		<legend><strong>Location 1</strong></legend>
		<label for="Lat1">Latitude (N):</label><br>
		<input type="text" id="Lat1" name="Latitude1" value="0"><br>
		<label for="Long1">Longitude (E):</label><br>
		<input type="text" id="Long1" name="Longitude1" value="0"><br><br>
	</fieldset>
</div>
<div class="span-11">
	<fieldset style="width:200px; background-color: cadetblue;">
		<legend><strong>Location 2</strong></legend>
		<label for="Site">Choose a Site:</label>
		<select name="selectSite" id="Site" onchange="myFunction(this)">
			<optgroup label="Alaska">
			<option value="pad1">Pad 1</option>
			</optgroup>
			<optgroup label="California">
			<option value="VAFB1">VAFB1</option>
			<option value="VAFB2">VAFB2</option>
			</optgroup>
		</select><br><br>
		<label for="Lat2">Latitude2 (N):</label><br>
		<input type="text" id="Lat2" name="Latitude2" value="0"><br>
		<label for="Long2">Longitude2 (E):</label><br>
		<input type="text" id="Long2" name="Longitude2" value="0"><br>
	</fieldset>
</div>
<input type="submit" value="Submit">
<input type="reset" value="Reset">
</form>
<br>
<div id="Pos1"></div>
<div id="Pos2"></div>
<div id="map"></div>
<script>
const forms = document.querySelectorAll('form')
const submitInput = forms[0].querySelector('input[type="submit"]')
function getData(e){
		e.preventDefault();
		const formdata = new FormData(forms[0])
		document.getElementById("Pos1").textContent = "Position1 Lat/Long:" + formdata.get("Latitude1") + formdata.get("Longitude1")
		document.getElementById("Pos2").innerHTML = `$(formdata.get("Latitude2")), $(formdata.get("Longitude2")`
		loadMap()
}

document.addEventListener('DOMContentLoaded',function(){
	submitInput.addEventListener('click', getData, false);
},false)
</script>

<script>
    function initMap(){

		// Map options
	  	var options = {
        	zoom:8,
        	center: {lat:42.3601,lng:-71.0589}
      	}

      // New map
      var map = new google.maps.Map(document.getElementById('map'), options);
	}
  </script>
  
  <script> async function loadMap() {
    const payload = {
		key: 'AIzaSyD8OhoxKqPqPifoJM4bh0ztgUjxt71VGFw',
		//callback: 'initMap'
	}
	const query = new URLSearchParams(payload)
	const url = "https://maps.googleapis.com/maps/api/js?" + query.toString()
	const response = await fetch(url)
	const data = await response.blob
	console.log(data)
  // async defer
  }
  </script>
</body>
</html>
<!--
	Step 1: Submit the form
	Step 2: Get the Heading, and Declination
	Step 3: Load the map, with markers
	Step 4: Display the info
-->